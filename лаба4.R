# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 4: call-–æ–ø—Ü–∏–æ–Ω ----

# 1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å {Bn} –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏ r = 0.01, 
# –∑–∞ –ø–µ—Ä–∏–æ–¥ ùëÅ = 200 –ø—Ä–∏ B0 = 1. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫;

r = 0.01
N = 200
B = array(N)
B[1] = 1
for(n in 2 : N)
{  
  B[n] = (1 + r)*B[n-1]
}
plot(B, type = 'l', main = "–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å {Bn} –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏")

# 2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å {Sn}, –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: 
# S0 = 1, ùëÅ = 200, ùëé = ‚àí0.3, ùëè = 0.8, ùëù = 0.4. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫.

N = 200
S = array(N)
S[1] = 1
a = -0.3
b = 0.8
p = 0.4
œÅ = rbinom(N, 1, p) # –≤–µ–∫—Ç–æ—Ä –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

for(i in 1 : N) 
{
  if(œÅ[i] == 1) 
    œÅ[i] = b
  else 
    œÅ[i] = a
}

for(n in 2 : N)
{
  S[n] = (1 + œÅ[n])*S[n-1] 
}

plot(S, type = 'l', main = "–°–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å {Sn} –ø—Ä–∏ –∑–∞–¥–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö")

# 3. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—É—é —Ü–µ–Ω—É call-–æ–ø—Ü–∏–æ–Ω–∞ –ø–æ —Ñ–æ—Ä–º—É–ª–µ (7) –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö 
# –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: S0 = 100, ùëÅ = 10, ùëé = ‚àí0.3, ùëè = 0.8, ùëü = 0.2, ùêæ = 100.

N = 10
a = -0.3
b = 0.8
r = 0.2
K = 100
S0 = 100 
p1 = (r - a)/(b - a) 
p2 = ((1 + b)/(1 + r))*p1
K0 = 1 + log(K/(S0*(1 + a)^N))*(log((1 + b)/(1 + a)))^(-1); K0
B = function(j, N, p) 
{
  sum = 0
  for(k in j : N)
    sum = sum + (factorial(N)/(factorial(k)*factorial(N - k)))*p^k*(1 - p)^(N - k)
  return(sum)
}
CN = S0*B(K0, N, p2) - K*(1 + r)^(-N)*B(K0, N, p1) # —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
CN

